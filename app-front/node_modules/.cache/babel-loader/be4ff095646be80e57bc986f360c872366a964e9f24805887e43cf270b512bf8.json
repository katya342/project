{"ast":null,"code":"// AccountPage.js\nimport React,{useState,useEffect}from'react';import api from'../../api';import{Navigate,useNavigate}from'react-router-dom';import SubsComponent from'../subscriptions/SubsComponent';import UserWorkouts from'../workouts/UserWorkouts';import styles from\"./AccountPage.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const AccountPage=()=>{const[userData,setUserData]=useState(null);const[showModal,setShowModal]=useState(false);const[modalMessage,setModalMessage]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();useEffect(()=>{api.get('/user/data').then(response=>{// console.log(response.data);\nsetUserData(response.data);}).catch(error=>{console.error('Error fetching user data:',error);setError(\"Account not found\");}).finally(()=>{setLoading(false);});},[]);const handleDeleteAccount=()=>{if(window.confirm('Are you sure you want to delete your account?')){const userId=userData&&userData.user_id;if(userId){api.delete(\"/subscription/delete/\".concat(userId)).then(()=>{// Now, delete the user\nreturn api.delete(\"/delete/\".concat(userId));}).then(response=>{localStorage.clear();setModalMessage('Account deleted successfully');setShowModal(true);navigate('/home');}).catch(error=>{console.error('Error deleting account:',error);});}};};const handleLogoutAccount=()=>{localStorage.setItem('logoutNotification','true');localStorage.clear();setModalMessage('Logout successfully');setShowModal(true);};const handleCloseModal=()=>{setShowModal(false);navigate('/home');};if(!userData||loading){return/*#__PURE__*/_jsx(\"div\",{children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[userData&&/*#__PURE__*/_jsxs(\"div\",{className:styles.userInfo,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Name: \",userData.user_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",userData.user_email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Last workout check: \",userData.last_check]}),/*#__PURE__*/_jsx(SubsComponent,{}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger\",onClick:handleDeleteAccount,children:\"Delete account\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:handleLogoutAccount,children:\"Logout\"})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.userWorkouts,children:/*#__PURE__*/_jsx(UserWorkouts,{})})]});};export default AccountPage;","map":{"version":3,"names":["React","useState","useEffect","api","Navigate","useNavigate","SubsComponent","UserWorkouts","styles","jsx","_jsx","jsxs","_jsxs","AccountPage","userData","setUserData","showModal","setShowModal","modalMessage","setModalMessage","loading","setLoading","error","setError","navigate","get","then","response","data","catch","console","finally","handleDeleteAccount","window","confirm","userId","user_id","delete","concat","localStorage","clear","handleLogoutAccount","setItem","handleCloseModal","children","className","container","userInfo","user_name","user_email","last_check","type","onClick","userWorkouts"],"sources":["C:/Proggramming/app-front/src/components/account/AccountPage.js"],"sourcesContent":["// AccountPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport api from '../../api';\r\n\r\nimport { Navigate, useNavigate } from 'react-router-dom';\r\nimport SubsComponent from '../subscriptions/SubsComponent';\r\nimport UserWorkouts from '../workouts/UserWorkouts';\r\nimport styles from \"./AccountPage.module.css\";\r\n\r\n\r\nconst AccountPage = () => {\r\n  const [userData, setUserData] = useState(null);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [modalMessage, setModalMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  \r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    \r\n    api.get('/user/data')\r\n      .then(response => {\r\n        // console.log(response.data);\r\n        setUserData(response.data);\r\n      })\r\n      .catch(error => {\r\n        console.error('Error fetching user data:', error);\r\n        setError(\"Account not found\");\r\n      })\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, []);\r\n\r\n  const handleDeleteAccount = () => {\r\n    if (window.confirm('Are you sure you want to delete your account?')) {\r\n\r\n      const userId = userData && userData.user_id;\r\n\r\n      if (userId) {\r\n     \r\n        api.delete(`/subscription/delete/${userId}`)\r\n          .then(() => {\r\n            // Now, delete the user\r\n            return api.delete(`/delete/${userId}`);\r\n          })\r\n          .then(response => {\r\n            localStorage.clear();\r\n            setModalMessage('Account deleted successfully');\r\n            setShowModal(true);\r\n            navigate('/home');\r\n          })\r\n          .catch(error => {\r\n            console.error('Error deleting account:', error);\r\n          });\r\n    }\r\n  };\r\n}\r\n  const handleLogoutAccount = () => {\r\n    localStorage.setItem('logoutNotification', 'true');\r\n    localStorage.clear();\r\n    setModalMessage('Logout successfully');\r\n    setShowModal(true);\r\n \r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setShowModal(false);\r\n    navigate('/home');\r\n\r\n  };\r\n \r\nif (!userData || loading) {\r\n   return (\r\n    <div>\r\n      {error}\r\n    </div>\r\n\r\n   );\r\n}\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {userData && (\r\n        <div className={styles.userInfo}>\r\n          <p>Name: {userData.user_name}</p>\r\n          <p>Email: {userData.user_email}</p>\r\n          <p>Last workout check: {userData.last_check}</p>\r\n          <SubsComponent />\r\n          <button type=\"button\"  className=\"btn btn-danger\" onClick={handleDeleteAccount}>Delete account</button>\r\n          <button type=\"button\" className=\"btn btn-primary\" onClick={handleLogoutAccount}>Logout</button>\r\n        </div>\r\n       \r\n      )}\r\n      \r\n      <div className={styles.userWorkouts}>\r\n        <UserWorkouts></UserWorkouts>\r\n      </div>\r\n\r\n      {/* <Modal show={showModal} onHide={handleCloseModal}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Success</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>{modalMessage}</Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"primary\" onClick={handleCloseModal}>\r\n            Close\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal> */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AccountPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}