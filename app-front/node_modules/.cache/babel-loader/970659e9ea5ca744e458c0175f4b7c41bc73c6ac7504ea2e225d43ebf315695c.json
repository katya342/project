{"ast":null,"code":"import{useEffect,useState}from\"react\";import api from\"../../api\";import styles from\"./FeedBack.module.css\";import Star from\"./Star\";import{BASE_URL}from\"../constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const FeedBack=props=>{const[data,setData]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[inputValue,setInputValue]=useState(\"\");const[rating,setRating]=useState(0);useEffect(()=>{const fetchData=async()=>{try{const response=await api.get(\"feedbacks/\".concat(props.planId));setData(response.data.success);}catch(error){setError(error);}finally{setLoading(false);}};fetchData();},[props.planId]);const handleAddComment=async()=>{try{await api.post(\"/add/feedback/\".concat(props.planId,\"/\").concat(props.trainerId),{comment:inputValue,rating:rating});// Очистить поле ввода и сбросить рейтинг после успешной отправки\nsetInputValue(\"\");setRating(0);// Перезагрузить данные после отправки комментария\nconst response=await api.get(\"feedbacks/\".concat(props.planId));setData(response.data.success);}catch(error){console.error(\"Error adding comment:\",error);}};const handleChange=event=>{setInputValue(event.target.value);};const handleRatingChange=event=>{setRating(event.target.value);};const renderStars=rating=>{let stars=[];for(let i=1;i<=5;i++){stars.push(/*#__PURE__*/_jsx(Star,{filled:i<=rating},i));}return stars;};return/*#__PURE__*/_jsxs(\"div\",{children:[data.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:styles[\"comment-container\"],children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(BASE_URL,\"storage/\").concat(item.avatar),alt:\"Cannot display image\",width:50}),/*#__PURE__*/_jsx(\"div\",{children:item.user.name}),/*#__PURE__*/_jsx(\"div\",{className:styles[\"comment-header\"],children:item.name}),/*#__PURE__*/_jsx(\"div\",{className:styles[\"comment-body\"],children:item.comment}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Rating: \",renderStars(item.rating)]}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"comment-footer\"],children:[\"Posted on: \",item.created_at]})]},item.id)),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Write comment here\",value:inputValue,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Rating\",value:rating,onChange:handleRatingChange}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddComment,children:\"Add comment\"})]});};export default FeedBack;","map":{"version":3,"names":["useEffect","useState","api","styles","Star","BASE_URL","jsx","_jsx","jsxs","_jsxs","FeedBack","props","data","setData","loading","setLoading","error","setError","inputValue","setInputValue","rating","setRating","fetchData","response","get","concat","planId","success","handleAddComment","post","trainerId","comment","console","handleChange","event","target","value","handleRatingChange","renderStars","stars","i","push","filled","children","map","item","className","src","avatar","alt","width","user","name","created_at","id","placeholder","onChange","type","onClick"],"sources":["C:/Proggramming/app-front/src/components/subscriptions/FeedBack.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport api from \"../../api\";\r\nimport styles from \"./FeedBack.module.css\";\r\nimport Star from \"./Star\";\r\nimport { BASE_URL } from \"../constants\";\r\n\r\n\r\nconst FeedBack = (props) => {\r\n    const [data, setData] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [inputValue, setInputValue] = useState(\"\");\r\n    const [rating, setRating] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const response = await api.get(`feedbacks/${props.planId}`);\r\n                setData(response.data.success);\r\n            } catch (error) {\r\n                setError(error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, [props.planId]);\r\n\r\n    const handleAddComment = async () => {\r\n        try {\r\n            await api.post(`/add/feedback/${props.planId}/${props.trainerId}`, {\r\n                comment: inputValue,\r\n                rating: rating\r\n            });\r\n            // Очистить поле ввода и сбросить рейтинг после успешной отправки\r\n            setInputValue(\"\");\r\n            setRating(0);\r\n            // Перезагрузить данные после отправки комментария\r\n            const response = await api.get(`feedbacks/${props.planId}`);\r\n            setData(response.data.success);\r\n        } catch (error) {\r\n            console.error(\"Error adding comment:\", error);\r\n        }\r\n    };\r\n\r\n    const handleChange = (event) => {\r\n        setInputValue(event.target.value);\r\n    };\r\n\r\n    const handleRatingChange = (event) => {\r\n        setRating(event.target.value);\r\n    };\r\n\r\n    const renderStars = (rating) => {\r\n        let stars = [];\r\n        for (let i = 1; i <= 5; i++) {\r\n            stars.push(<Star key={i} filled={i <= rating} />);\r\n        }\r\n        return stars;\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {data.map((item) => (\r\n                <div key={item.id} className={styles[\"comment-container\"]}>\r\n                    <img src={`${BASE_URL}storage/${item.avatar}`} alt=\"Cannot display image\" width={50}></img>\r\n                    <div>{item.user.name}</div>\r\n                    <div className={styles[\"comment-header\"]}>{item.name}</div>\r\n                    <div className={styles[\"comment-body\"]}>{item.comment}</div>\r\n                    <div>Rating: {renderStars(item.rating)}</div>\r\n                    <div className={styles[\"comment-footer\"]}>Posted on: {item.created_at}</div>\r\n                </div>\r\n            ))}\r\n            <textarea placeholder=\"Write comment here\" value={inputValue} onChange={handleChange}></textarea>\r\n            <input type=\"number\" placeholder=\"Rating\" value={rating} onChange={handleRatingChange} />\r\n            <button onClick={handleAddComment}>Add comment</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FeedBack;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}